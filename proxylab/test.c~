#include <stdio.h>
#include "./csapp.h"

/* 
 * parse url static version: http://www.cmu.edu:8080/hub/index.html
 * or dynamic version: http://bluefish.ics.cs.cmu.edu:8000/cgi-bin/adder?15000&213
 * to get 
 * host: www.cmu.edu
 * path: /hub/index.html
 * port: 8080 (default 80)
 */
int parse_url(char *url, char *host, char *path, char* port) {
    // default port is 80
    port = "80";
    char *pos = strstr(url, "//");
    if (!pos)
        return -1;
    pos += 2;
    char *colon = strstr(pos, ":");
    char *slash = strstr(pos, "/"); 

    if (!slash) {
        strcat(pos, "/");
        slash = strstr(pos, "/");
    } else {
        sscanf(slash, "%s", path);   
    }

    if (colon) {
        *colon = '\0';
        sscanf(pos, "%s", host);
        strncpy(port, colon + 1, slash - colon + 1);
    }
}

